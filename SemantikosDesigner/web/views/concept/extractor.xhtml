<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/WEB-INF/template/template.xhtml">

    <ui:define name="header">
        <p:breadCrumb>
            <p:menuitem value="Inicio" url="/views/home.xhtml" />
            <p:menuitem value="Administración de Usuarios" url="#" />
        </p:breadCrumb>

    </ui:define>


    <ui:define name="content">
        <div class="Container100">
        <div class="ContainerIndent">
        <div class="Card ShadowEffect">

        <h:form id="extractorForm">

                <p:growl id="msg" showDetail="true" autoUpdate="true" />
                <p:growl id="messages1" showDetail="true"/>

            <div class="ui-fluid">

            <h:panelGrid columns="2" layout="grid">

                <p:outputLabel value="Categorías" />

                <p:selectCheckboxMenu id="categories"
                                      value="#{conceptExtractBean.selectedCategories}"
                                      converter="omnifaces.SelectItemsConverter"
                                      label="Seleccione..."
                                      autoWidth="false"
                                      filter="true"
                                      filterMatchMode="startsWith">

                    <f:selectItems value="#{conceptExtractBean.categoryList}" var="category"
                                   itemLabel="#{category.name}" itemValue="#{category}"/>

                </p:selectCheckboxMenu>

                <p:commandButton value="Ejecutar" styleClass="ui-priority-primary"
                                                  onclick="PF('poll').start()"
                                                  actionListener="#{conceptExtractBean.extract}" />

                <p:poll interval="1" update="@(.process-state)" widgetVar="poll" autoStart="false" async="true" process="@this" />

            </h:panelGrid>

            </div>

            <br/>

            <h:dataTable value="#{conceptExtractBean.selectedCategories}" var="cat" styleClass="process-state">
                <h:column>
                    <h:outputText value="#{cat.name}" />
                </h:column>
                <h:column>
                    <p:progressBar labelTemplate="{value}%" styleClass="animated"
                                   value="#{(conceptExtractBean.concepts.get(cat.id).size()/conceptExtractBean.sizes.get(cat.id))*100}"/>
                </h:column>
            </h:dataTable>

        </h:form>

        </div>
        </div>
        </div>

    <h:outputStylesheet id="customCSS">
        .animated .ui-progressbar-value {
            background-image: url("/resources/semantikos/images/ajax-loader.gif");
        }
    </h:outputStylesheet>

    </ui:define>

</ui:composition>